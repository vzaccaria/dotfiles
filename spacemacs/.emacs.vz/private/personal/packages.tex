% Created 2017-09-26 Tue 09:31
% Intended LaTeX compiler: pdflatex
\documentclass[presentation]{beamer}
\usetheme{default}
\author{Vittorio Zaccaria}
\date{\today}
\title{}
\hypersetup{
 pdfauthor={Vittorio Zaccaria},
 pdftitle={},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 25.1.1 (Org mode 9.0.4)}, 
 pdflang={English}}
\begin{document}

\begin{frame}{Outline}
\tableofcontents
\end{frame}

;;; packages.el --- personal layer packages file for Spacemacs.


(defconst personal-packages
  '(
    org
    org-bullets
    spell-checking
    prodigy
    evil-multiedit
    livescript-mode
    highlight-chars
    pretty-mode
    writeroom-mode
    matlab-mode
    (ox-extra :location local)
    (prettier-js :location local)
    ))


(defun personal/init-pretty-mode ()
  (use-package pretty-mode
    :init
    (progn (global-pretty-mode t)

(pretty-deactivate-groups
 '(:equality :ordering :ordering-double :ordering-triple
             :arrows :arrows-twoheaded :punctuation
             :logic :sets))

         (pretty-activate-groups
          '(:sub-and-superscripts :greek :arithmetic-nary))
         (global-prettify-symbols-mode 1)
         ;; See here for adding symbols to your major mode: \url{https://ekaschalk.github.io/}
         (add-hook
          'haskell-mode-hook
          (lambda ()
            (mapc (lambda (pair) (push pair prettify-symbols-alist))
                  '(;; Syntax
                    ("`nd`" .\#x2227)
                    (".\&"   .\#x2227)
                    ("`xr`" .\#x2295)
                    (".+"   .\#x2295)
                    ("nt"   .\#x00ac)
                    ("neg"  .\#x00ac)
                    (".|"   .\#x2228)
                    ("\(_{\text{0}}\)"   .\#x2080)
                    ("\(_{\text{1}}\)"   .\#x2081)
                    (".<>"  .\#x20df)
                    ("top"  .\#x22a4)
                    ("bot"  .\#x22a5)
                    ))))
         (add-hook 'LaTeX-mode-hook
                   (lambda ()
                     (push '("$\backslash$\item"    . ?●) prettify-symbols-alist)
                     (push '("$\backslash$\begin{itemize}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{itemize}"    . ?↲) prettify-symbols-alist)
                     (push '("$\backslash$\begin{example}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{example}"    . ?↲) prettify-symbols-alist)
                     (push '("$\backslash$\begin{theorem}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{theorem}"    . ?↲) prettify-symbols-alist)
                     (push '("$\backslash$\begin{proof}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{proof}"    . ?↲) prettify-symbols-alist)
                     (push '("$\backslash$\begin{definition}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{definition}"    . ?↲) prettify-symbols-alist)
                     (push '("$\backslash$\begin{equation}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{equation}"    . ?↲) prettify-symbols-alist)
                     (push '("$\backslash$\begin{equation*}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{equation*}"    . ?↲) prettify-symbols-alist)
                     (push '("$\backslash$\begin{eqnarray*}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{eqnarray*}"    . ?↲) prettify-symbols-alist)
                     (push '("$\backslash$\begin{eqnarray}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{eqnarray}"    . ?↲) prettify-symbols-alist)
                     (push '("$\backslash$\begin{remark}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{remark}"    . ?↲) prettify-symbols-alist)
                     (push '("$\backslash$\begin{corollary}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{corollary}"    . ?↲) prettify-symbols-alist)
                     (push '("$\backslash$\begin{align}"    . ?↴) prettify-symbols-alist)
                     (push '("$\backslash$\end{align}"    . ?↲) prettify-symbols-alist)
                     ))
         ))
)

(defun personal/init-highlight-chars ()
  (use-package highlight-chars)
  )

(defun personal/init-livescript-mode ()
  (use-package livescript-mode
    :defer t
    :init
    (progn
      (add-to-list 'auto-mode-alist '("$\backslash$\.ls$\backslash$\'" . livescript-mode))
      (evil-leader/set-key-for-mode 'livescript-mode
        "mc" 'livescript-compile-buffer
        "mC" 'livescript-compile-region
        "mr" 'livescript-repl)
      (add-hook 'livescript-mode-hook '(lambda ()
                                         (setq livescript-command "lsc"))
                )
      )))


(defun personal/post-init-spell-checking ()
  (setq-default ispell-program-name "/usr/local/bin/aspell")
  )

(defun personal/post-init-matlab-mode ()
  (add-to-list
   'auto-mode-alist
   '("$\backslash$\.m\$" . matlab-mode))
  (setq matlab-indent-function t)
  (setq matlab-shell-command "/Applications/MATLAB\(_{\text{R2015b.app}}\)/bin/matlab")
  )

;; define initialization here
(defun personal/post-init-org ()
  (require 'org-protocol)
  (require 'org-drill)
  (require 'ox)
  (setq org-agenda-custom-commands '(("w" "My Agenda"
                                      ((agenda "")
                                       (tags "TODO=$\backslash$"TODAY$\backslash$"")
                                       (tags "TODO=$\backslash$"IMPORTANT$\backslash$"\&-PRIORITY=$\backslash$"C$\backslash$"")
                                       (tags "TODO=$\backslash$"IMPORTANT$\backslash$"\&PRIORITY=$\backslash$"C$\backslash$"")
                                       (tags "DEADLINE=\{.\}-TODO=$\backslash$"DONE$\backslash$"")
                                       (tags "TODO=$\backslash$"TODO$\backslash$"\&-TODO=$\backslash$"IMPORTANT$\backslash$"")
                                       ))))

(setq org-columns-default-format "\%40ITEM(Task) \%17Effort(Estimated Effort)\{:\} \%CLOCKSUM") 
(setq org-agenda-todo-list-sublevels nil)

;; Add files recursively
(load-library "find-lisp")
(setq org-agenda-files
      (find-lisp-find-files "\textasciitilde{}/Dropbox/org" "\(_{\text{ag$\backslash$.org}}\)\$"))

(setq org-todo-keywords
      '((sequence "TODO" "TODAY" "IMPORTANT" "CHECK" "|" "DONE" "CANCELLED")
        (sequence "TOREIMBURSE" "|" "REIMBURSED"  )))

;; Using orgmode as a presentation
(setq org-hide-emphasis-markers t)
(setq org-hide-leading-stars t)
(setq org-level-color-stars-only t )
(setq org-confirm-babel-evaluate nil)

(add-hook 'org-mode-hook (lambda () 
                           (define-key org-mode-map "\M-e" 'personal/show-agenda-all)))

(define-key global-map "\C-ct"
  (lambda () (interactive) (org-capture nil "t")))

(org-babel-do-load-languages
 'org-babel-load-languages
 '(
   (emacs-lisp . t)
   (shell . t)
   (haskell . t)
   (js . t)
   (C . t)  
   (ditaa . t)
   (plantuml . t)
   (latex . t)
   ))


(org-add-link-type "papers3" (lambda (link)  (shell-command (concat "open papers3:" link))))

(setq org-babel-js-cmd "node")
(setq org-plantuml-jar-path "/usr/local/Cellar/plantuml/1.2017.16/libexec/plantuml.jar")
(setq org-capture-templates
      '(
        ("t" "Work todo generico" entry
         (file+headline "\textasciitilde{}/Dropbox/org/institutional/work\(_{\text{ag.org}}\)" "Ricordarsi di \ldots{}")
         "* TODO \%?\n  \%i\n")

("l" "Da leggere" entry
 (file+headline "\textasciitilde{}/Dropbox/org/institutional/work\(_{\text{ag.org}}\)" "Da categorizzare")
 "\alert{*} [ ] \%c\n")

("c" "Note/Annotazioni per i corsi" entry
 (file+headline "\textasciitilde{}/Dropbox/org/institutional/work\(_{\text{ag.org}}\)" "Note per i corsi")
 "** \%c - \%i (\%u)"
 )
))

(setf org-latex-default-packages-alist
      (remove '("AUTO" "inputenc" t) org-latex-default-packages-alist))

(setq org-structure-template-alist
      '(("s" "\#+BEGIN\(_{\text{SRC}}\) ?\n\n\#+END\(_{\text{SRC}}\)")
        ("e" "\#+BEGIN\(_{\text{EXAMPLE}\n}\)?\n\#+END\(_{\text{EXAMPLE}}\)")
        ("q" "\#+BEGIN\(_{\text{QUOTE}\n}\)?\n\#+END\(_{\text{QUOTE}}\)")
        ("v" "\#+BEGIN\(_{\text{VERSE}\n}\)?\n\#+END\(_{\text{VERSE}}\)")
        ("V" "\#+BEGIN\(_{\text{VERBATIM}\n}\)?\n\#+END\(_{\text{VERBATIM}}\)")
        ("c" "\#+BEGIN\(_{\text{CENTER}\n}\)?\n\#+END\(_{\text{CENTER}}\)")
        ("l" "\#+BEGIN\(_{\text{EXPORT}}\) latex\n?\n\#+END\(_{\text{EXPORT}}\)")
        ("L" "\#+\LaTeX{}: ")
        ("h" "\#+BEGIN\(_{\text{EXPORT}}\) html\n?\n\#+END\(_{\text{EXPORT}}\)")
        ("H" "\#+HTML: ")
        ("a" "\#+BEGIN\(_{\text{EXPORT}}\) ascii\n?\n\#+END\(_{\text{EXPORT}}\)")
        ("A" "\#+ASCII: ")
        ("i" "\#+INDEX: ?")
        ("I" "\#+INCLUDE: \%file ?")
        ("st" "\#+STARTUP: showall indent latexpreview entitiespretty")
        ("oh" "\#+TITLE:    Title\n\#+INCLUDE: beamer\(_{\text{modern.org}\n}\)\#+STARTUP: showall indent latexpreview entitiespretty")

;;; --- SOURCES ---
     ("so"  "\#+BEGIN\(_{\text{SRC}}\) octave :results none   \n\n\#+END\(_{\text{SRC}}\)")
     ("ss"  "\#+BEGIN\(_{\text{SRC}}\) sh     :results none   \n\n\#+END\(_{\text{SRC}}\)")
     ("sc"  "\#+BEGIN\(_{\text{SRC}}\) c      :results none   \n\n\#+END\(_{\text{SRC}}\)")
     ("sj"  "\#+BEGIN\(_{\text{SRC}}\) js     :results none   \n\n\#+END\(_{\text{SRC}}\)")
     ("sjt" "\#+BEGIN\(_{\text{SRC}}\) js :tangle js/yourfile.js   \n\n\#+END\(_{\text{SRC}}\)")

;;; --- FIGURES ---
     ("fe" "\#+BEGIN\(_{\text{EXPORT}}\) latex\n$\backslash$\begin{figure}\n\n$\backslash$\end{figure}\n\#+END\(_{\text{EXPORT}}\)")
     ("fc" "\#+CAPTION: caption with label $\backslash$\label{l1}\n\#+attr\(_{\text{latex}}\): :width 0.85$\backslash$\linewidth :float t :placement [h]")
     ("tg" "$\backslash$\begin{tikzpicture}\n$\backslash$\graph[layered layout, level distance=1cm]\{ a -> \{b, c\} \};\n$\backslash$\end{tikzpicture}")
     ("tc" "$\backslash$\begin{tikzpicture}[start chain=1 going right,node distance=5mm] \n $\backslash$\node [draw,on chain=1] \{Hello\}; \n$\backslash$\node [draw,on chain] \{World\}; \n$\backslash$\end{tikzpicture}")

;;; --- GENERIC LATEX

("als" "\#+attr\(_{\text{latex}}\): :font $\backslash$\footnotesize")
("al" "\#+attr\(_{\text{latex}}\): :font $\backslash$\footnotesize :width 0.85$\backslash$\linewidth :float t :placement [h]")
("alf" "\#+attr\(_{\text{latex}}\): :width 0.85$\backslash$\linewidth :float t :placement [h]")

;;; --- EXAMPLES ---
     ("ec" "\#+begin\(_{\text{center}}\) \n \#+attr\(_{\text{latex}}\): :options \{0.7$\backslash$\textwidth\} \n \#+begin\(_{\text{minipage}}\) \n \#+BEGIN\(_{\text{EXAMPLE}}\) \n \#+END\(_{\text{EXAMPLE}}\) \n \#+end\(_{\text{minipage}}\) \n \#+end\(_{\text{center}}\) \n")

;;; --- EQUATIONS --- 
     ("equ" "\#+BEGIN\(_{\text{EXPORT}}\) latex\n$\backslash$\begin{equation}\n$\backslash$\end{equation}\n\#+END\(_{\text{EXPORT}}\)")
     ("eqc" "f(x) = $\backslash$\begin{cases}\n 1 \& $\backslash$\text{for } n = 0 $\backslash$\$\backslash$\ \n $\backslash$\end{cases}\n")
     ("eqa" "$\backslash$\begin{array}{rcl}\n a\& = \&b $\backslash$\$\backslash$\\n$\backslash$\end{array}\n")
     ("eql" "\#+BEGIN\(_{\text{EXPORT}}\) latex\n$\backslash$\begin{align}\n a\& = \&b $\backslash$\$\backslash$\\n$\backslash$\end{align}\n\#+END\(_{\text{EXPORT}}\)")

;;; --- MATRICES ---
     ("mat" "M = $\backslash$\left($\backslash$\begin{array}{ccc}\n a\& = \&b $\backslash$\$\backslash$\\n$\backslash$\end{array}$\backslash$\right)\n")

;;; --- MINI PAGES and COLUMNS
     ("hp" "\#+attr\(_{\text{latex}}\): :options \{0.5$\backslash$\textwidth\}\n\#+begin\(_{\text{minipage}\n\n}\)\#+end\(_{\text{minipage}}\)")
     ("btc" "\alert{*}\n :PROPERTIES:\n :BEAMER\(_{\text{env}}\): column\n :BEAMER\(_{\text{col}}\): 0.5\n :END:\n  \#+BEGIN\(_{\text{footnotesize}}\) \n\n \#+END\(_{\text{footnotesize}}\) \n")
     ("brc" "\alert{*}\n :PROPERTIES:\n :BEAMER\(_{\text{env}}\): column\n :BEAMER\(_{\text{col}}\): 0.32\n :END:\n \#+BEGIN\(_{\text{footnotesize}}\) \n\n \#+END\(_{\text{footnotesize}}\) \n"))
   )




(unless (boundp 'org-latex-classes)
  (setq org-latex-classes nil))

(add-to-list 'org-latex-classes
             '("memoir"
               "$\backslash$\documentclass$\backslash${memoir$\backslash$}
              [NO-DEFAULT-PACKAGES]"
               ("$\backslash$\chapter{%s}" . "$\backslash$\chapter*{%s}")
               ("$\backslash$\section{%s}" . "$\backslash$\section*{%s}")
               ("$\backslash$\subsection{%s}" . "$\backslash$\subsection*{%s}")
               ("$\backslash$\subsubsection{%s}" . "$\backslash$\subsubsection*{%s}")
               ("$\backslash$\paragraph{%s}" . "$\backslash$\paragraph*{%s}")
               ("$\backslash$\subparagraph{%s}" . "$\backslash$\subparagraph*{%s}")
               ))

(add-to-list 'org-latex-classes
             '("IEEETran"
               "$\backslash$\documentclass$\backslash${IEEEtran$\backslash$}
              [NO-DEFAULT-PACKAGES]"
               ("$\backslash$\section$\backslash${\%s$\backslash$}" . "$\backslash$\section*$\backslash${\%s$\backslash$}")
               ("$\backslash$\subsection$\backslash${\%s$\backslash$}" . "$\backslash$\subsection*$\backslash${\%s$\backslash$}")
               ("$\backslash$\subsubsection$\backslash${\%s$\backslash$}" . "$\backslash$\subsubsection*$\backslash${\%s$\backslash$}")
               ))

(add-to-list 'org-latex-classes
             '("article"
               "$\backslash$\documentclass[a4]$\backslash${article$\backslash$}
              [NO-DEFAULT-PACKAGES]"
               ("$\backslash$\section$\backslash${\%s$\backslash$}" . "$\backslash$\section*$\backslash${\%s$\backslash$}")
               ("$\backslash$\subsection$\backslash${\%s$\backslash$}" . "$\backslash$\subsection*$\backslash${\%s$\backslash$}")
               ("$\backslash$\subsubsection$\backslash${\%s$\backslash$}" . "$\backslash$\subsubsection*$\backslash${\%s$\backslash$}")))

(add-to-list 'org-latex-classes
             '("letter"
               "$\backslash$\documentclass$\backslash${letter$\backslash$}
              [NO-DEFAULT-PACKAGES]"
               ))

    ;;; same for beamer
(add-to-list 'org-latex-classes
             '("beamer"
               "$\backslash$\documentclass\[presentation\]$\backslash${beamer$\backslash$}
              [NO-DEFAULT-PACKAGES]"
               ("$\backslash$\section$\backslash${\%s$\backslash$}" . "$\backslash$\section*$\backslash${\%s$\backslash$}")
               ("$\backslash$\subsection$\backslash${\%s$\backslash$}" . "$\backslash$\subsection*$\backslash${\%s$\backslash$}")
               ("$\backslash$\subsubsection$\backslash${\%s$\backslash$}" . "$\backslash$\subsubsection*$\backslash${\%s$\backslash$}")))


;; duplicated.. dont ask me..
;; the following are needed to compile correctly lecture files.
(unless (boundp 'org-export-latex-classes)
  (setq org-export-latex-classes nil))

(add-to-list 'org-export-latex-classes
             '("article"
               "$\backslash$\documentclass$\backslash${article$\backslash$}
              [NO-DEFAULT-PACKAGES]"
               ("$\backslash$\section$\backslash${\%s$\backslash$}" . "$\backslash$\section*$\backslash${\%s$\backslash$}")
               ("$\backslash$\subsection$\backslash${\%s$\backslash$}" . "$\backslash$\subsection*$\backslash${\%s$\backslash$}")
               ("$\backslash$\subsubsection$\backslash${\%s$\backslash$}" . "$\backslash$\subsubsection*$\backslash${\%s$\backslash$}")))

    ;;; same for beamer
(add-to-list 'org-export-latex-classes
             '("beamer"
               "$\backslash$\documentclass\[presentation\]$\backslash${beamer$\backslash$}
              [NO-DEFAULT-PACKAGES]"
               ("$\backslash$\section$\backslash${\%s$\backslash$}" . "$\backslash$\section*$\backslash${\%s$\backslash$}")
               ("$\backslash$\subsection$\backslash${\%s$\backslash$}" . "$\backslash$\subsection*$\backslash${\%s$\backslash$}")
               ("$\backslash$\subsubsection$\backslash${\%s$\backslash$}" . "$\backslash$\subsubsection*$\backslash${\%s$\backslash$}")))

(setq org-export-default-inline-image-rule
      '(("file" . "$\backslash$\.$\backslash$\(gif\\|jp\\(?:e?g\\)$\backslash$\|p$\backslash$\(?:bm\\|df\\|gm\\|ng\\|pm\\)$\backslash$\|tiff?$\backslash$\|x$\backslash$\(?:[bp]m\\)$\backslash$\)$\backslash$\'"))
      )

(setq org-pomodoro-finished-sound "\emph{Users/zaccaria/dotfiles/spacemacs}.emacs.vz/private/personal/assets/pomodoro0.wav")
(setq org-pomodoro-long-break-sound "\emph{Users/zaccaria/dotfiles/spacemacs}.emacs.vz/private/personal/assets/pomodoro0.wav")
(setq org-pomodoro-short-break-sound "\emph{Users/zaccaria/dotfiles/spacemacs}.emacs.vz/private/personal/assets/pomodoro0.wav")

;; Override general keybindings for orgmode

(define-key org-read-date-minibuffer-local-map (kbd "\e [5D")
  (lambda () (interactive) (org-eval-in-calendar '(calendar-backward-day 1))))
(define-key org-read-date-minibuffer-local-map (kbd "\e [5C")
  (lambda () (interactive) (org-eval-in-calendar '(calendar-forward-day 1))))
(define-key org-read-date-minibuffer-local-map (kbd "\e [5E")
  (lambda () (interactive) (org-eval-in-calendar '(calendar-backward-week 1))))
(define-key org-read-date-minibuffer-local-map (kbd "\e [5B")
  (lambda () (interactive) (org-eval-in-calendar '(calendar-forward-week 1))))

;; We want to use arrow keys for moving between windows in org-mode as well

(define-key org-mode-map (kbd "\e <up>")   'evil-window-up)
(define-key org-mode-map (kbd "\e <down>") 'evil-window-down)
(define-key org-mode-map (kbd "\e <right>")'evil-window-right)
(define-key org-mode-map (kbd "\e <left>") 'evil-window-left)

(define-key org-mode-map (kbd "M-<up>")    'evil-window-up)
(define-key org-mode-map (kbd "M-<down>")  'evil-window-down)
(define-key org-mode-map (kbd "M-<right>") 'evil-window-right)
(define-key org-mode-map (kbd "M-<left>")  'evil-window-left)

(define-key org-mode-map (kbd "M-p")  'org-preview-latex-fragment)

(setq org-format-latex-options (plist-put org-format-latex-options :scale 0.7))

)


(defun personal/init-evil-multiedit ()
  (use-package evil-multiedit
    :config
    (progn
      (evil-multiedit-default-keybinds)
      )
    )
  )

(defun personal/init-writeroom-mode ()
  (use-package writeroom-mode
    :commands (writeroom-mode)
    :init
    (evil-leader/set-key "Tw" 'writeroom-mode)
    :config
    (setq writeroom-restore-window-config t)
    (setq writeroom-width 100)
    ))


(defun personal/post-init-org-bullets ()
  (add-hook 'org-mode-hook (lambda () (org-bullets-mode 1)))
  )

(defun personal/show-agenda-all ()
  ;; Show agenda and todo list
  (interactive)
  (org-agenda nil "w"))



(defun personal/post-init-prodigy ()
  (prodigy-define-service
    :name "After The Deadline"
    :env '(("LANG" "en\(_{\text{US.UTF}}\)-8")
           ("LC\(_{\text{CTYPE}}\)" "en\(_{\text{US.UTF}}\)-8"))

  :command "java"
  :args '("-Dfile.encoding=UTF-8" "-XX:+AggressiveHeap" "-XX:+UseParallelGC" "-Datd.lowmem=true" "-Dbind.interface=127.0.0.1" "-Dserver.port=1049" "-Dsleep.classpath=\$ATD\(_{\text{HOME}}\)/lib:\$ATD\(_{\text{HOME}}\)/service/code" "-Dsleep.debug=24" "-classpath" "./lib/sleep.jar:./lib/moconti.jar:./lib/spellutils.jar:./lib/*" "httpd.Moconti" "atdconfig.sl")
  :cwd "/Users/zaccaria/development/github/after-the-deadline-server/atd"
  :tags '(grammar)
  :kill-signal 'sigterm
  :kill-process-buffer-on-stop t)
(prodigy-define-service
  :name "Language Tool"
  :command "/usr/local/bin/languagetool-server"
  :tags '(grammar)
  :kill-process-buffer-on-stop t)
)



;; (defun personal/init-helm-mu ()
;;   (spacemacs/set-leader-keys
;;     "a m s" 'helm-mu
;;     "a m c" 'helm-mu-contacts))

(defun personal/init-helm-mu ()
  (use-package helm-mu
    :defer t
    :commands helm-mu
    :init
    (require 'helm-config)
    (spacemacs/set-leader-keys "oM" 'helm-mu
      "oC" 'helm-mu-contacts))
  ) 


(defun personal/init-mu4e ()
  (use-package mu4e
    :defer t
    :commands mu4e
    :config
    (setq mu4e-maildir "\textasciitilde{}/mu-mail/")
    (setq mu4e-get-mail-command "offlineimap -f INBOX")
    (setq mu4e-trash-folder "\emph{[Gmail].Trash"
          mu4e-refile-folder "}[Gmail].All Mail"
          mu4e-sent-folder "\emph{[Gmail].Sent Mail"
          mu4e-drafts-folder "}[Gmail].Drafts"
          ;; update every 5 minutes
          mu4e-update-interval 360
          mu4e-split-view 'horizontal 
          mu4e-headers-auto-update t
          mu4e-hide-index-messages t
          mu4e-headers-leave-behavior 'apply
          mu4e-headers-visible-columns 100
          mu4e-compose-signature-auto-include nil
          mu4e-view-show-images t
          mu4e-view-show-addresses t)

;; don't keep message buffers around
(setq message-kill-buffer-on-exit t)
(setq mu4e-use-fancy-chars  t
      mu4e-headers-attach-mark '("" . "")
      mu4e-headers-encrypted-mark '("" . "")
      mu4e-headers-flagged-mark '("+" . "⚑")
      mu4e-headers-list-mark '("" . "")
      mu4e-headers-new-mark '("" . "")
      mu4e-headers-read-mark '("" . "")
      mu4e-headers-replied-mark '("" . "↩")
      mu4e-headers-seen-mark '("" . "")
      mu4e-headers-unseen-mark '("" . "")
      mu4e-headers-unread-mark '("" . "✱")
      mu4e-headers-signed-mark '("" . "")
      mu4e-headers-from-or-to-prefix '("" . "→ ")
      mu4e-headers-has-child-prefix '("+" . "└┬")
      mu4e-headers-first-child-prefix '("|" . "├")
      mu4e-headers-default-prefix '("" . "├"))



(setq mu4e-sent-messages-behavior 'delete)

(setq mu4e-contexts
      `(
        ,(make-mu4e-context
          :name "Work"
          :enter-func (lambda () (mu4e-message "Switch to Work Context"))
          ;; leave-func not defined

:match-func (lambda (msg)
              (let ((email "vittorio.zaccaria@polimi.it"))
                (when msg
                  (or
                   (mu4e-message-contact-field-matches msg :to email)
                   (mu4e-message-contact-field-matches msg :cc email)
                   (mu4e-message-contact-field-matches msg :from email)
                   ))))


:vars '(  ( user-mail-address	. "vittorio.zaccaria@polimi.it"  )
          ( user-full-name	    . "Vittorio Zaccaria" )
          ))

,(make-mu4e-context
  :name "Private"
  :enter-func (lambda () (mu4e-message "Switch to the Private context"))
  ;; leave-func not defined

:match-func (lambda (msg)
              (let ((email "vittorio.zaccaria@gmail.com"))
                (when msg
                  (or
                   (mu4e-message-contact-field-matches msg :to email)
                   (mu4e-message-contact-field-matches msg :cc email)
                   (mu4e-message-contact-field-matches msg :from email)
                   ))))


:vars '(  ( user-mail-address	. "vittorio.zaccaria@gmail.com"  )
          ( user-full-name	    . "Vittorio Zaccaria" )
          ))

))

(setq mu4e-context-policy 'pick-first)
(setq mu4e-compose-context-policy 'pick-first)

;; This sets `mu4e-user-mail-address-list' to the concatenation of all
;; `user-mail-address' values for all contexts. If you have other mail
;; addresses as well, you'll need to add those manually.
(setq mu4e-user-mail-address-list
      (delq nil
            (mapcar (lambda (context)
                      (when (mu4e-context-vars context)
                        (cdr (assq 'user-mail-address (mu4e-context-vars context)))))
                    mu4e-contexts)))

;; make sure the gnutls command line utils are installed
;; package 'gnutls-bin' in Debian/Ubuntu

(setq message-send-mail-function 'smtpmail-send-it
      starttls-use-gnutls t
      smtpmail-starttls-credentials '(("smtp.gmail.com" 587 nil nil))
      smtpmail-auth-credentials
      '(("smtp.gmail.com" 587 "vittorio.zaccaria@gmail.com" nil))
      smtpmail-default-smtp-server "smtp.gmail.com"
      smtpmail-smtp-server "smtp.gmail.com"
      smtpmail-smtp-service 587)

;; headers view
(setq mu4e-headers-results-limit 500
      mu4e-headers-show-threads t
      ;; mu4e-headers-skip-duplicates t
      mu4e-headers-date-format "\%d \%b \%Y"
      mu4e-headers-time-format "\%H:\%M"
      mu4e-headers-fields
      '( (:human-date     .  15)
         (:flags          .   5)
         (:from           .  30)
         (:subject        .  nil))
      mu4e-headers-sort-field :date
      mu4e-headers-sort-direction 'descending)

(setq mu4e-bookmarks
      '(
        ("maildir:/INBOX"                        "Inbox"               ?i)
        ("date:today..now"                       "Today"               ?t)

))

(spacemacs|use-package-add-hook mu4e
  :post-config
  (progn
    (add-to-list 'mu4e-view-actions '("gopen in gmail" . djr/mu4e-open-message-in-google) t)
    (add-to-list 'mu4e-view-actions '("rview related" . djr/mu4e-view-related-search) t)))


(add-hook 'mu4e-compose-mode-hook
          (defun my-do-compose-stuff ()
            "My settings for message composition."
            (set-fill-column 72)
            (ispell-change-dictionary "italiano")
            ))

(add-hook 'mu4e-headers-mode-hook
          (defun my-headers-mode-customization ()
            "My settings for headers mode"
            (define-key mu4e-headers-mode-map (kbd "<mouse-1>") 'mu4e-headers-view-message)
            )
          )


  (setq mu4e-maildir-shortcuts
        '( ("/INBOX"       . ?i)
           ("/Sent Mail"   . ?s)
           ("/Drafts"      . ?d)
           ("/Trash"       . ?t)
           ("/All Mail"    . ?a)))
  )
)

(defun personal/init-ox-extra ()
  (use-package ox-extra
    :config
    (ox-extras-activate '(ignore-headlines))
    )
  )

(defun personal/init-prettier-js ()
  (use-package prettier-js
    :config
    (add-hook 'js-mode-hook
              (lambda ()
                (add-hook 'before-save-hook 'prettier-before-save)))

(add-hook 'js2-mode-hook
          (lambda ()
            (add-hook 'before-save-hook 'prettier-before-save)))

(add-hook 'react-mode-hook
          (lambda ()
            (add-hook 'before-save-hook 'prettier-before-save)))
)
)
\end{document}